# S&P 500 Data Collector (yfinance)

Цей застосунок автоматично збирає історичні та оновлювані дані OHLC + Volume для компаній індексу S&P 500 через API Yahoo Finance (yfinance), і зберігає їх у PostgreSQL базу даних.
## Чому PostgreSQL?
Обрав PostgreSQL, оскільки це потужна, надійна та перевірена часом реляційна СУБД, яка добре підходить для роботи зі структурованими даними, зокрема часовими рядами (OHLC + volume). Вона підтримує складні SQL-запити, має хорошу продуктивність та активно використовується в продакшн-середовищах.

## Функціонал

- Таймфрейми:
  - **1 день (daily)** — останні 2 роки
  - **1 година (hourly)** — останні 20 днів
  - **5 хвилин (5min)** — останні 2 дні
- Запуск кожного таймфрейму окремо з відповідним інтервалом:
  - `daily` — щодня
  - `hourly` — щогодини
  - `5min` — кожні 5 хвилин
- Дані зберігаються у відповідні таблиці бази даних (`sp500_daily`, `sp500_hourly`, `sp500_minute`)

---

## Встановлення та запуск

### 1. Клонування репозиторію

```
git clone https://github.com/ValentynSaska/SP_500_Library_TEST.git
cd S&P_500
```
### 2. Встановлення залежностей

```
pip install -r requirements.txt
```

### 3. Налаштування .env файл

```
Видалити префікс [delete_this_prefix]

як має виглядати:

.env[delete_this_prefix] -> .env
```
Ось як має бути заповнення:

```
DB_NAME=назва_бази
DB_USER=користувач
DB_PASSWORD=пароль
DB_HOST=localhost
DB_PORT=5432
```

### 4. Налаштування бази даних


Створити базу PostgreSQL і таблиці, які описані у ddl.sql. Це зробить скрипт автоматично при першому запуску.

Таблиці створюються в схемі sp500. Якщо вона не створилась то в ddl.sql написано вигляд БД

### 5. Запуск скрипт

```
python main.py
```

## Структура проєкту

```
SP_500_Library_TEST/
│
├── main.py           # Основний скрипт
├── ddl.sql           # SQL-файл з DDL інструкціями для створення таблиць
├── .env              # Змінні оточення (додайте вручну)
├── requirements.txt  # Python-залежності
└── README.md         # Інструкція
```
## Примітки

- Використовується yfinance API, який не має суворих обмежень, але надмірне навантаження може призводити до блокувань.
- Символи S&P 500 отримуються автоматично зі сторінки Вікіпедії та коригуються під формат yfinance (наприклад, BRK.B → BRK-B).
- Асинхронне завантаження даних і циклічний запуск для кожного таймфрейму з заданим інтервалом.
- Під час вставки даних в таблицю використовується ON CONFLICT DO NOTHING, щоб уникнути дублювань.


